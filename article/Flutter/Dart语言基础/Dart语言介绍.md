# Dart语言介绍

## 为什么使用Dart语言开发
程序主要有两种运行方式：静态编译与动态解释。静态编译的程序在执行前全部被编译为机器码，通常将这种类型称为AOT （Ahead of time）即 “提前编译”；而解释执行的则是一句一句边翻译边运行，通常将这种类型称为JIT（Just-in-time）即“即时编译”。AOT程序的典型代表是用C/C++开发的应用，它们必须在执行前编译成机器码，而JIT的代表则非常多，如JavaScript、python等，事实上，所有脚本语言都支持JIT模式。但需要注意的是JIT和AOT指的是程序运行方式，和编程语言并非强关联的，有些语言既可以以JIT方式运行也可以以AOT方式运行，如Java、Python，它们可以在第一次执行时编译成中间字节码、然后在之后执行时可以直接执行字节码，也许有人会说，中间字节码并非机器码，在程序执行时仍然需要动态将字节码转为机器码，是的，这没有错，不过通常我们区分是否为AOT的标准就是看代码在执行之前是否需要编译，只要需要编译，无论其编译产物是字节码还是机器码，都属于AOT。在此，读者不必纠结于概念，概念就是为了传达精神而发明的，只要读者能够理解其原理即可，得其神忘其形。

现在我们看看Flutter为什么选择Dart语言？笔者根据官方解释以及自己对Flutter的理解总结了以下几条（由于其它跨平台框架都将JavaScript作为其开发语言，所以主要将Dart和JavaScript做一个对比）：

1. 开发效率高  

    Dart运行时和编译器支持Flutter的两个关键特性的组合：

    基于JIT的快速开发周期：Flutter在开发阶段采用，采用JIT模式，这样就避免了每次改动都要进行编译，极大的节省了开发时间；

    基于AOT的发布包: Flutter在发布时可以通过AOT生成高效的ARM代码以保证应用性能。而JavaScript则不具有这个能力。

2. 高性能

    Flutter旨在提供流畅、高保真的的UI体验。为了实现这一点，Flutter中需要能够在每个动画帧中运行大量的代码。这意味着需要一种既能提供高性能的语言，而不会出现会丢帧的周期性暂停，而Dart支持AOT，在这一点上可以做的比JavaScript更好。

3. 快速内存分配

    Flutter框架使用函数式流，这使得它在很大程度上依赖于底层的内存分配器。因此，拥有一个能够有效地处理琐碎任务的内存分配器将显得十分重要，在缺乏此功能的语言中，Flutter将无法有效地工作。当然Chrome V8的JavaScript引擎在内存分配上也已经做的很好，事实上Dart开发团队的很多成员都是来自Chrome团队的，所以在内存分配上Dart并不能作为超越JavaScript的优势，而对于Flutter来说，它需要这样的特性，而Dart也正好满足而已。

4. 类型安全

    由于Dart是类型安全的语言，支持静态类型检测，所以可以在编译前发现一些类型的错误，并排除潜在问题，这一点对于前端开发者来说可能会更具有吸引力。与之不同的，JavaScript是一个弱类型语言，也因此前端社区出现了很多给JavaScript代码添加静态类型检测的扩展语言和工具，如：微软的TypeScript以及Facebook的Flow。相比之下，Dart本身就支持静态类型，这是它的一个重要优势。

5. Dart团队就在（Flutter团队）旁边

    看似不起眼，实则举足轻重。由于有Dart团队的积极投入，Flutter团队可以获得更多、更方便的支持，正如Flutter官网所述：“我们正与Dart社区进行密切合作，以改进Dart在Flutter中的使用。例如，当我们最初采用Dart时，该语言并没有提供生成原生二进制文件的工具链（这对于实现可预测的高性能具有很大的帮助），但是现在它实现了，因为Dart团队专门为Flutter构建了它。同样，Dart VM之前已经针对吞吐量进行了优化，但团队现在正在优化VM的延迟时间，这对于Flutter的工作负载更为重要。”

## 重要的概念

在学习 Dart 的时候，请牢记下面一些事实和概念：

1. 所有能够使用变量引用的都是对象， 每个对象都是一个类的实例。在 Dart 中 甚至连 数字、方法和 `null` 都是对象。所有的对象都继承于 `Object` 类。

2. 使用`静态类型`可以更清晰的表明你的意图，并且可以让静态分析工具来分析你的代码， 但这并不是强制性的。（在调试代码的时候你可能注意到，没有指定类型的变量为 `dynamic` 的类型。）Dart 在运行之前会先解析你的代码。可以通过使用`类型`或者`编译时常量`来帮助 Dart 去捕获异常以及让代码运行的更高效。

3. Dart 支持顶级方法 (例如 `main()`)，同时还支持在类中定义函数（静态函数和实例函数）。你还可以在方法中定义方法（嵌套方法或者局部方法）。

4. Dart 还支持顶级变量，以及在类中定义变量（静态变量和实例变量）。实例变量有时候被称之为域（Fields）或者属性（Properties）。

5. Dart 没有 `public`、 `protected`、 和 `private` 关键字。如果一个标识符以 (`_`) 开头，则该标识符在库内是私有的。详情请参考：[库和可见性](http://localhost:4000/Dart%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80/Dart%E8%AF%AD%E6%B3%95%E6%A6%82%E8%A7%88.html#%E5%BA%93%E5%92%8C%E5%8F%AF%E8%A7%81%E6%80%A7)。
标识符可以以字母或者 `_` 下划线开头，后面可以是其他字符和数字的组合。

6. 有时候，表达式 `expression` 和语句 `statement` 是有区别的，所以这种情况会分别指明。

7. Dart 工具可以指出两种问题：警告和错误。 警告只是说你的代码可能有问题， 但是并不会阻止你的代码执行。 错误可以是编译时错误也可以是运行时错误。遇到编译时错误时，代码将无法执行；运行时错误将会在运行代码的时候导致一个异常。

